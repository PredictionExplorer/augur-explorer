<html>
<head>
	<link href="/black/res/main.css" rel="stylesheet">
	<title>Open Interest history for Polymarkets Market {{.MarketId}}</title>
</head>
<body>
	<h3 class="page_title">Open Interest history for market id = {{.MarketId}}</h3>
<table class="market_detail">
</table>
<div id="price_history_graph"></div>
<h3>Collateral Transfers</h3>
This table shows all the flow of Collateral from source to destination, covering all the intermediate steps
<table>
	<tr class="market_reports">
		<th class="market_reports">TxId</th>
		<th class="market_reports">Date </th>
		<th class="market_reports">From Address</th>
		<th class="market_reports">To Address</th>
		<th class="market_reports">Amount (USDC)</th>
		<th class="market_reports">Fee <br>(USDC)</th>
		<th class="market_reports">Accum. Fees <br>(USDC)</th>
		<th class="market_reports">Open Interest<br>(UDSC)</th>
		<th class="market_reports">Notes</th>

	</tr>
	{{- range $i, $change := .OIHistory}}
		<tr class="market_reports">
			<td class="market_reports_field">
				{{ if gt .TxId 0 }}
					{{.TxId}}
				{{ end }}
			</td>
			<td class="market_reports_field" title="{{.BalChgId}}">
				{{.DateTime}}
			</td>
			<td class="addr" title="{{.FromAid}}">
				{{ if gt .TxId 0 }}
					{{ if eq .FromAid $.CondTokAid }}Conditional Tokens
					{{ else }}
						{{ if eq .FromAid $.USDCAid }}
							USDC
						{{ else }}
							{{ if eq .FromAid $.MktMkrAid }}
								Market Maker
							{{ else }}
								{{.FromAddr}}
							{{end}}
						{{ end }}
					{{end}}
				{{ else }}
					<b>Market resolved</b>
				{{ end }}
			</td>
			<td class="addr" title="{{.ToAid}}">
				{{ if eq .ToAid $.CondTokAid }}
					Conditional Tokens
				{{else}}
					{{if eq .ToAid $.USDCAid }}
						USDC
					{{else}}
						{{ if eq .ToAid $.MktMkrAid }}
							Market Maker
						{{ else }}
							{{.ToAddr}}
						{{ end }}
					{{end}}
				{{end}}
			</td>
			<td class="market_reports_field" style="text-align: right;">
				{{ if gt .TxId 0 }}{{printf "%.6f" .Amount}}{{end}}
			</td>
			<td class="market_reports_field" style="text-align: right;">
				{{ if gt .TxId 0 }}{{printf "%.6f" .Fee}}{{end}}
			</td>
			<td class="market_reports_field" style="text-align: right;">
				{{ if gt .TxId 0 }}{{printf "%.6f" .FeeAccum}}{{end}}
			</td>
			<td class="market_reports_field" style="text-align: right;">
				{{ if gt .TxId 0 }}{{printf "%.6f" .OpenInterest}}{{end}}
			</td>
			<td nowrap class="market_reports_field">
				{{ if gt .TxId 0 }}
					{{ if gt .BuySellOpId 0 }}
						{{ if eq .BuySellOpType 0 }} Buy {{ else }} Sell {{end}}
						{{ if eq .FromAid $.MktMkrAid }} (Market Maker contract sends funds to Conditional Tokens contract)
						{{ else }} (User sends funds to Market Maker contract ) {{ end }}
					{{ end }}
					{{ if gt .FundOpId 0 }}
						{{ if eq .FundOpType 0 }} Add Funds {{ else }} Remove Funds {{end}}
						{{ if eq .FromAid $.MktMkrAid }} (Market Maker contract sends funds to Conditional Tokens contract) 
						{{ else }} (Funder sends funds to Market Maket maker contract){{ end }}
					{{ end }}
					{{ if gt .RedeemId 0 }}Payout redemption (Conditional Tokens contract sends funds to the User){{end}}
					{{ if and (eq .BuySellOpId -1) (eq .FundOpId -1) (eq .RedeemId -1)}} User sends operation to Conditional Tokens contract bypassing Market Maker (probably to avoid paying fees) {{ end }}
				{{ else }}
					payout numerators are: {{.PayoutNumerators}}
				{{ end}}
			</td>
		</tr>
	{{- end}}
</table>
<br/><br/>
<h4>Totals</h4>
<table>
	<tr>
		<td>Final Open Interest</td>
		<td>{{printf "%.6f" .Totals.FinalOpenInterest }}</td>
	</tr>
	<tr>
		<td>Final Fees</td>
		<td>{{printf "%.6f" .Totals.FinalFees }}</td>
	</tr>
</table>
<br/><br/><br/>
</body>
</html>
